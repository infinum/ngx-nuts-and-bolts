<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Environment variables | ngx-nuts-and-bolts</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/services/environment-variables"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Environment variables | ngx-nuts-and-bolts"><meta data-react-helmet="true" name="description" content="Most applications that are deployed to multiple environments have a need for environment variables that can have different values, depending on which environment the app is running in. EnvironmentVariablesService and the corresponding modules from ngx-nuts-and-bolts allow for handling of environment variables in a way that does not require application to be re-built nor to be re-deployed (only restarted in the case of SSR). This allows the same build to be deployed to multiple environments, increasing reliability and providing confidence that the codebase that was tested in pre-production environment is identical to what gets deployed to production. Additionally, this approach works well with Docker - the same Docker image containing the build can be run with different environment values for different environments."><meta data-react-helmet="true" property="og:description" content="Most applications that are deployed to multiple environments have a need for environment variables that can have different values, depending on which environment the app is running in. EnvironmentVariablesService and the corresponding modules from ngx-nuts-and-bolts allow for handling of environment variables in a way that does not require application to be re-built nor to be re-deployed (only restarted in the case of SSR). This allows the same build to be deployed to multiple environments, increasing reliability and providing confidence that the codebase that was tested in pre-production environment is identical to what gets deployed to production. Additionally, this approach works well with Docker - the same Docker image containing the build can be run with different environment values for different environments."><link data-react-helmet="true" rel="icon" href="/ngx-nuts-and-bolts/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/services/environment-variables"><link data-react-helmet="true" rel="alternate" href="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/services/environment-variables" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/services/environment-variables" hreflang="x-default"><link rel="stylesheet" href="/ngx-nuts-and-bolts/assets/css/styles.d0db87f0.css">
<link rel="preload" href="/ngx-nuts-and-bolts/assets/js/runtime~main.fd1dadb6.js" as="script">
<link rel="preload" href="/ngx-nuts-and-bolts/assets/js/main.ea492df9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ngx-nuts-and-bolts/"><div class="navbar__logo"><img src="/ngx-nuts-and-bolts/img/logo.svg" alt="ngx-nuts-and-bolts" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/ngx-nuts-and-bolts/img/logo.svg" alt="ngx-nuts-and-bolts" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">ngx-nuts-and-bolts</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ngx-nuts-and-bolts/docs">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/infinum/ngx-nuts-and-bolts" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ngx-nuts-and-bolts/docs">Getting started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ngx-nuts-and-bolts/docs/directives/in-view">Directives</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ngx-nuts-and-bolts/docs/pipes/enum-property">Pipes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/ngx-nuts-and-bolts/docs/services/environment-variables">Services</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ngx-nuts-and-bolts/docs/services/environment-variables">Environment variables</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ngx-nuts-and-bolts/docs/animations">Animations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ngx-nuts-and-bolts/docs/utilities/loading-state">Utilities</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ngx-nuts-and-bolts/docs/testing/extract-public">Testing</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Environment variables</h1></header><p>Most applications that are deployed to multiple environments have a need for environment variables that can have different values, depending on which environment the app is running in. <code>EnvironmentVariablesService</code> and the corresponding modules from <code>ngx-nuts-and-bolts</code> allow for handling of environment variables in a way that does not require application to be re-built nor to be re-deployed (only restarted in the case of SSR). This allows the same build to be deployed to multiple environments, increasing reliability and providing confidence that the codebase that was tested in pre-production environment is identical to what gets deployed to production. Additionally, this approach works well with Docker - the same Docker image containing the build can be run with different environment values for different environments.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="1-features">1. Features<a class="hash-link" href="#1-features" title="Direct link to heading">â€‹</a></h2><p>Environment variables feature set consists of two main parts - <code>EnvironmentVariablesService</code> and a loader. <code>EnvironmentVariablesService</code> service is what is used in the application when you need to read some specific environment variable value. A loader is what initializes the <code>EnvironmentVariablesService</code> with actual values. Depending on project architecture, you might use one of two loaders that are provided with the library. If you seek something more specific, you can implement a custom loader.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="11-main-service-and-module">1.1. Main service and module<a class="hash-link" href="#11-main-service-and-module" title="Direct link to heading">â€‹</a></h3><p><code>EnvironmentVariablesService</code> is provided by <code>EnvironmentVariablesModule</code>. This module also provides an <code>APP_INITIALIZER</code> that uses the loader of you choice to initialize the service during application initialization.</p><p><code>init</code> method is intentionally available publicly and can be called multiple times in order not to restrict the users in whatever use cases they might have. If you use a loader, you probably will not have to call it from your application code (not even once), but it is available if you have the need for it.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="12-loaders">1.2. Loaders<a class="hash-link" href="#12-loaders" title="Direct link to heading">â€‹</a></h3><p>The two available loaders are <code>EnvironmentVariablesSSRLoader</code> and <code>EnvironmentVariablesStaticLoader</code>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="ssr-loader">SSR loader<a class="hash-link" href="#ssr-loader" title="Direct link to heading">â€‹</a></h4><p>As the name suggests, <code>EnvironmentVariablesSSRLoader</code> is to be used with Angular Universal (Server-Side Rendering) applications. It reads from <code>process.env</code> on server-side and transfers the values to the client browser using the <code>TransferState</code> service.</p><p>This is the recommended loader if you use SSR, although you can still use any other loader if there is a specific need.</p><p>Please note that this loader is part of a separate NPM package (<code>@infinumjs/ngx-nuts-and-bolts-ssr</code>) because of <code>node</code> dependency. This keeps the main NPM package (<code>@infinumjs/ngx-nuts-and-bolts</code>) free of any node dependencies.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="static-loader">Static loader<a class="hash-link" href="#static-loader" title="Direct link to heading">â€‹</a></h4><p>The main use case for <code>EnvironmentVariablesStaticLoader</code> is for statically built applications that do not use SSR.</p><p>Any custom loaders you might need to implement are injectable classes that implement <code>IEnvironmentVariablesLoader</code>. Please check out the source code of the two available loaders for some examples.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="13-race-conditions-during-application-initialization">1.3. Race conditions during application initialization<a class="hash-link" href="#13-race-conditions-during-application-initialization" title="Direct link to heading">â€‹</a></h3><p>Because all the <code>APP_INITIALIZER</code>s start being resolved at the same time, there is no guarantee in which order they will be resolved. This can cause issues if you have an asynchronous environment variables loader and you need to use <code>EnvironmentVariablesService</code> within some other <code>APP_INITIALIZER</code>s - it could happen that <code>EnvironmentVariablesService</code> is not initialized in time.</p><p>As a workaround for such cases, other initializers can await for <code>EnvironmentVariablesService</code>&#x27;s <code>initDone$</code> observable to emit <code>true</code>.</p><p><code>EnvironmentVariablesSSRLoader</code> and <code>EnvironmentVariablesStaticLoader</code> loaders that are provided with the library are not affected by this issue, but some custom loaders that are written for specific application needs might be.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="2-usage-and-example-applications">2. Usage and example applications<a class="hash-link" href="#2-usage-and-example-applications" title="Direct link to heading">â€‹</a></h2><p>Please follow these steps to set up the environment variables service and loaders:</p><ol><li><p>Define a string enum that defines all the needed environment variables</p><p>Example enum:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">FOO</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NGX_NUTS_AND_BOLTS_EXAMPLE_FOO&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">BAR</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NGX_NUTS_AND_BOLTS_EXAMPLE_BAR&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>Import <code>EnvironmentVariablesModule</code> into your <code>AppModule</code></p></li><li><p>Import an existing loader module or provide a custom loader (also in <code>AppModule</code>)</p></li><li><p>Inject <code>EnvironmentVariablesService</code> and call <code>get</code> method wherever you need some environment variable value</p></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="21-configuring-static-loader">2.1. Configuring static loader<a class="hash-link" href="#21-configuring-static-loader" title="Direct link to heading">â€‹</a></h3><p>Import <code>EnvironmentVariablesStaticLoaderModule</code> with or without config.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="with-config">With config<a class="hash-link" href="#with-config" title="Direct link to heading">â€‹</a></h4><p>This option will use fully static values that are defined when the module is imported. This can be useful for setting environment variables in development of if you are reading them from <code>window.env</code> or similar.</p><p>Some examples:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesStaticLoaderModule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">withConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            environmentVariablesRecord</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">FOO</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;I am Foo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">BAR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;I am Bar&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesStaticLoaderModule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">withConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            environmentVariablesRecord</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="without-config">Without config<a class="hash-link" href="#without-config" title="Direct link to heading">â€‹</a></h4><p>If the module is imported without calling <code>withConfig</code>, you need to provide the config manually. An example:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariablesModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">EnvironmentVariablesStaticLoaderModule</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            provide</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENVIRONMENT_VARIABLES_STATIC_LOADER_CONFIG</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token function-variable function" style="color:#d73a49">useFactory</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token dom variable" style="color:#36acaa">window</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Window</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    environmentVariablesRecord</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">env</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            deps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token constant" style="color:#36acaa">WINDOW</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            provide</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">WINDOW</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            useValue</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token dom variable" style="color:#36acaa">window</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This example is functionally the same as <code>EnvironmentVariablesStaticLoaderModule.withConfig</code> example where window.env was used directly (without injection token). Generally, it is a good practice to hide globals behind injection tokens and your app might already have an injection token for <code>Window</code> because you are using something else from <code>Window</code> as well. The example above shows how to use that injection token when configuring <code>EnvironmentVariablesStaticLoader</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="22-configuring-ssr-loader">2.2. Configuring SSR loader<a class="hash-link" href="#22-configuring-ssr-loader" title="Direct link to heading">â€‹</a></h3><p>Before using <code>EnvironmentVariablesSSRLoader</code>, make sure that <code>BrowserTransferStateModule</code> is imported, because <code>EnvironmentVariablesSSRLoader</code> depends on <code>TransferState</code>.</p><p>There can be many different environment variables present on the server where your Angular Universal application is running. <code>EnvironmentVariablesSSRLoader</code> has to be configured with information about which variables should be read from <code>process.env</code>. Be careful not to expose any secrets to the browser (e.g. various tokens/keys that are present in <code>process.env</code>). This can be done as shown in this example:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">BrowserModule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">withServerTransition</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> appId</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;serverApp&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">BrowserTransferStateModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesSSRLoaderModule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">withConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            variablesToLoad</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">FOO</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">BAR</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="23-implementing-and-providing-a-custom-loader">2.3. Implementing and providing a custom loader<a class="hash-link" href="#23-implementing-and-providing-a-custom-loader" title="Direct link to heading">â€‹</a></h3><p>Implement an injectable class that implements <code>IEnvironmentVariablesLoader</code>:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">Injectable</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">MyEnvironmentVariablesLoader</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name maybe-class-name">TVariable</span><span class="token class-name"> </span><span class="token class-name keyword" style="color:#00009f">extends</span><span class="token class-name"> </span><span class="token class-name builtin">string</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">implements</span><span class="token plain"> </span><span class="token class-name maybe-class-name">IEnvironmentVariablesLoader</span><span class="token class-name operator" style="color:#393A34">&lt;</span><span class="token class-name maybe-class-name">TVariable</span><span class="token class-name operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">public</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">EnvironmentVariablesRecord</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">TVariable</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token maybe-class-name">Observable</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">EnvironmentVariablesRecord</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">TVariable</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Provide your custom loader:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariablesModule</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            provide</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENVIRONMENT_VARIABLES_LOADER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            useClass</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">MyEnvironmentVariablesLoader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="24-setting-values-for-development-only">2.4. Setting values for development only<a class="hash-link" href="#24-setting-values-for-development-only" title="Direct link to heading">â€‹</a></h3><p>During development, you might want to set environment variables so that, for example, <code>API_URL</code> points to a localhost proxy. At the same time, don&#x27;t want these development URLs to be part of the final application bundle. There are multiple ways to achieve this. One possible solution is to provide a custom loader only in development mode, like so:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    imports</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesModule</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token maybe-class-name">EnvironmentVariablesSSRLoaderModule</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">withConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            variablesToLoad</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">values</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// Development mode variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token spread operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">environment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">production</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        provide</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ENVIRONMENT_VARIABLES_LOADER</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        useValue</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token function-variable function" style="color:#d73a49">load</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">API_URL</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;http://localhost:4200/api&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Because we use <code>environment.production</code>, custom loader will be tree-shaken at build-time and will not be present in the production application bundle - it will only be used during development. This keeps the production bundle clear of any development-related environment variables values. You can also consider adding an additional boolean to your environment files, e.g. <code>useDevelopmentEnvironmentVariablesValues</code>. The value of this property will most probably be in-sync with <code>production</code> property value but it does not have to be, especially if you have more than two environment files.</p><p>There is an opinion piece later on in this documentation page describing what we should or should not use environment files for. This is a good example of a use case where we can use environment files.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="25-example-applications">2.5. Example applications<a class="hash-link" href="#25-example-applications" title="Direct link to heading">â€‹</a></h3><p>Please check out the source code repository for two example applications.</p><p><a href="https://github.com/infinum/ngx-nuts-and-bolts/tree/main/apps/environment-variables-fetch-example" target="_blank" rel="noopener noreferrer"><code>apps/environment-variables-fetch-example</code></a> demonstrates an example that uses <code>EnvironmentVariablesStaticLoader</code>. In <code>main.ts</code> (before the application is loaded), <code>./assets/env.json</code> is fetched using <code>fetch</code> and the application is bootstrapped with the loader provided in <code>main.ts</code> instead of <code>app.module.ts</code> (as you would do usually). You can start this example with <code>npm run start:environment-variables-fetch-example</code>.</p><p><a href="https://github.com/infinum/ngx-nuts-and-bolts/tree/main/apps/environment-variables-ssr-example" target="_blank" rel="noopener noreferrer"><code>apps/environment-variables-ssr-example</code></a> uses <code>EnvironmentVariablesSSRLoader</code>. The application has to be started with environment variables exposed to the node process that is running the SSR app. You can start this example with <code>npm run start:environment-variables-ssr-example</code></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="3-opinion-piece---what-about-angulars-environment-files">3. Opinion piece - what about Angular&#x27;s <code>environment</code> files?<a class="hash-link" href="#3-opinion-piece---what-about-angulars-environment-files" title="Direct link to heading">â€‹</a></h2><p>While Angular provides environment files out-of-the-box (one for development and one for production), but they are not the best solution to this problem for multiple reasons:</p><ul><li>Any changes to these files require application re-build and re-deployment</li><li>Adding a new requirement requires code changes</li><li>One build per environment<ul><li>At best, this is sub-optimal</li><li>At worst, it can lead to situations where you think that the builds for different environments were made from the same commit, but something might have been pushed in the meantime and the builds will be different</li></ul></li><li>One file is required for each environment</li><li>A configuration entry has to be added to <code>angular.json</code> for each file</li><li>Conceptually, the frontend repository should not care about any URLs or other values that are related to the deployment process - they should be stored in the deployment pipeline<ul><li>The only thing that is OK to keep in the frontend repository are URLs for development proxies</li></ul></li><li>Some projects have a CI/CD setup such that each branch gets deployed to some unique environment so that the application is available online as part of pull request and design review processes. This is basically impossible to do with environment files without some hacky file copying and/or search-and-replace of some placeholder values</li></ul><p>Although these out-of-the-box files are named <code>environment.ts</code> and <code>environment.prod.ts</code>, Angular CLI has refers to these files in the <code>configurations</code> segment of <code>angular.json</code>. Basically, there is a 1-to-1 mapping between build configurations in <code>angular.json</code> and <code>environment.ts</code> files. <code>configurations</code> would probably be a more suitable name because these files are not the best fit for defining environment-specific values likeAPI URL, for all the reasons mentioned before. The main purpose for these files should be to define differences in build configurations - think of them as pragmas. Out-of-the-box they are used to determine whether Angular should run in production or development mode. Similar to the out-of-the-box <code>production</code> boolean property, you might have some custom properties that are used, for example, to determine if something should be logged or not in different build configurations.</p><p>Even though one of the configurations is called <code>production</code> and the other <code>development</code>, these are usually the only two configurations you actually need. In environments where it is important to provide a optimized build to the end-user, use <code>production</code> configuration. In environments where it is important that you can easily debug the deployed code, use <code>development</code> configuration. Even if you have many different environments, you are probably still ok with using one of these two configurations in each of the environments (e.g. <code>production</code> configuration for production and pre-production environments and <code>development</code> for development environments). You might want to add one additional middle-ground configuration that has all the optimizations enabled, but also includes sourcemaps that can be used to help with debugging. Basically <code>production</code> configuration + sourcemaps on top.</p><p>We can only hope that one day Angular CLI completely drops <code>environment</code> from naming and starts calling these files <code>configuration</code> files (e.g. <code>configuration.dev.ts</code>, <code>configuration.prod.ts</code>). This would better convey use cases where these files are a good fit. Environment variables should be kept out of these files in most applications. If you think these files will work for your use case, feel free to use them. However, we believe that they are not a good fit for anything other than some really small-scale and/or demo projects.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ngx-nuts-and-bolts/docs/pipes/enum-property"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">EnumProperty pipe</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ngx-nuts-and-bolts/docs/animations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Fade and Height animations</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-features" class="table-of-contents__link toc-highlight">1. Features</a><ul><li><a href="#11-main-service-and-module" class="table-of-contents__link toc-highlight">1.1. Main service and module</a></li><li><a href="#12-loaders" class="table-of-contents__link toc-highlight">1.2. Loaders</a></li><li><a href="#13-race-conditions-during-application-initialization" class="table-of-contents__link toc-highlight">1.3. Race conditions during application initialization</a></li></ul></li><li><a href="#2-usage-and-example-applications" class="table-of-contents__link toc-highlight">2. Usage and example applications</a><ul><li><a href="#21-configuring-static-loader" class="table-of-contents__link toc-highlight">2.1. Configuring static loader</a></li><li><a href="#22-configuring-ssr-loader" class="table-of-contents__link toc-highlight">2.2. Configuring SSR loader</a></li><li><a href="#23-implementing-and-providing-a-custom-loader" class="table-of-contents__link toc-highlight">2.3. Implementing and providing a custom loader</a></li><li><a href="#24-setting-values-for-development-only" class="table-of-contents__link toc-highlight">2.4. Setting values for development only</a></li><li><a href="#25-example-applications" class="table-of-contents__link toc-highlight">2.5. Example applications</a></li></ul></li><li><a href="#3-opinion-piece---what-about-angulars-environment-files" class="table-of-contents__link toc-highlight">3. Opinion piece - what about Angular&#39;s <code>environment</code> files?</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Infinum</div></div></div></footer></div>
<script src="/ngx-nuts-and-bolts/assets/js/runtime~main.fd1dadb6.js"></script>
<script src="/ngx-nuts-and-bolts/assets/js/main.ea492df9.js"></script>
</body>
</html>