<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Environment variables | ngx-nuts-and-bolts</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/environment-variables"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Environment variables | ngx-nuts-and-bolts"><meta data-react-helmet="true" name="description" content="1. Introduction"><meta data-react-helmet="true" property="og:description" content="1. Introduction"><link data-react-helmet="true" rel="icon" href="/ngx-nuts-and-bolts/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/environment-variables"><link data-react-helmet="true" rel="alternate" href="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/environment-variables" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://infinum.github.io/ngx-nuts-and-bolts//ngx-nuts-and-bolts/docs/environment-variables" hreflang="x-default"><link rel="stylesheet" href="/ngx-nuts-and-bolts/assets/css/styles.d0db87f0.css">
<link rel="preload" href="/ngx-nuts-and-bolts/assets/js/runtime~main.e09e271c.js" as="script">
<link rel="preload" href="/ngx-nuts-and-bolts/assets/js/main.565489e3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ngx-nuts-and-bolts/"><div class="navbar__logo"><img src="/ngx-nuts-and-bolts/img/logo.svg" alt="ngx-nuts-and-bolts" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/ngx-nuts-and-bolts/img/logo.svg" alt="ngx-nuts-and-bolts" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">ngx-nuts-and-bolts</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ngx-nuts-and-bolts/docs">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/infinum/ngx-nuts-and-bolts" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/ngx-nuts-and-bolts/docs/environment-variables">Environment variables</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs/loading-state">Loading state helpers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs/table-state">Table state helpers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs/in-view">InView directive</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs/enum-property">EnumProperty pipe</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs/animations">Fade and height animations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs/form-utils">Form utils</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ngx-nuts-and-bolts/docs/di-token-type">DI Token Type</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ngx-nuts-and-bolts/docs/testing-utils/extract-public">Testing utilities</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Environment variables</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="1-introduction">1. Introduction<a class="hash-link" href="#1-introduction" title="Direct link to heading">â€‹</a></h2><p>Most applications that are deployed to multiple environments have a need for environment variables that can have different values, depending on which environment the app is running in.</p><p><code>EnvironmentVariablesService</code> and the corresponding providers from <code>ngx-nuts-and-bolts</code> allow for handling of environment variables in a way that does not require application to be re-built nor to be re-deployed (only restarted in the case of SSR). This allows the same build to be deployed to multiple environments, increasing reliability and providing confidence that the codebase that was tested in pre-production environment is identical to what gets deployed to production. Additionally, this approach works well with Docker - the same Docker image containing the build can be run with different environment values for different environments.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="2-features">2. Features<a class="hash-link" href="#2-features" title="Direct link to heading">â€‹</a></h2><p>Environment variables feature set consists of two main parts - <code>EnvironmentVariablesService</code> and providers. <code>EnvironmentVariablesService</code> service is what is used in the application when you need to read some specific environment variable value. A provider is what initializes the <code>EnvironmentVariablesService</code> with actual values. Depending on project architecture, you might use the provider that is available in the library, or you might create your own provider that suits your specific needs.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="21-available-variables-enum">2.1. Available variables enum<a class="hash-link" href="#21-available-variables-enum" title="Direct link to heading">â€‹</a></h2><p>Before starting anything, it is recommended that you define a string enum that will be used for defining all the available environment variables that can be set and read.</p><p>Example:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Foo</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NGX_NUTS_AND_BOLTS_EXAMPLE_FOO&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token maybe-class-name">Bar</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;NGX_NUTS_AND_BOLTS_EXAMPLE_BAR&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This enum will be used in place of some generic values for things like <code>EnvironmentVariablesService</code>, <code>ENVIRONMENT_VARIABLES_RECORD</code> and <code>EnvironmentVariablesRecord</code></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="22-environmentvariablesservice">2.2. <code>EnvironmentVariablesService</code><a class="hash-link" href="#22-environmentvariablesservice" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="221-methods">2.2.1. Methods<a class="hash-link" href="#221-methods" title="Direct link to heading">â€‹</a></h3><p><code>EnvironmentVariablesService</code> exposes methods like <code>get</code>, <code>getAsNumber</code> and <code>getAsBoolean</code> that allow you to read environment variable values directly, or try to convert them to a number or a boolean before returning the value. Please read JSDoc comments for more information about each of the methods.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="222-configuration">2.2.2. Configuration<a class="hash-link" href="#222-configuration" title="Direct link to heading">â€‹</a></h3><p><code>EnvironmentVariablesService</code> can be configured by setting a value under <code>ENVIRONMENT_VARIABLES_CONFIG</code> DI token to an object that satisfies <code>IEnvironmentVariablesConfig</code> interface. You can use <code>provideEnvironmentVariablesServiceConfig</code> functional provider. The configuration object has the following properties:</p><ul><li><code>truthyBooleanStrings</code> - An array of strings that will, when reading environment variable via <code>getAsBoolean</code>, be consider <code>true</code>. Before comparison, the actual value is converted to lowercase. The default value is <code>[&#x27;true&#x27;, &#x27;1&#x27;]</code>.</li></ul><p>This configuration is applied no matter how the environment variables values are provided (SPA or SSR).</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="23-providers">2.3 Providers<a class="hash-link" href="#23-providers" title="Direct link to heading">â€‹</a></h2><p><code>EnvironmentVariablesService</code> depends on variables and their values to be provided via <code>DI</code>. There are two providers that are available in the library (one for SPA and one for SSR) that should cover most use cases, and a way to create your own provider.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="231-for-spa-apps---provideenvironmentvariables">2.3.1. For SPA Apps - <code>provideEnvironmentVariables</code><a class="hash-link" href="#231-for-spa-apps---provideenvironmentvariables" title="Direct link to heading">â€‹</a></h3><p><code>provideEnvironmentVariables</code> is a simple function that receives an object and returns a provider. The passed object must have all the environment variables that are used in the application.</p><p>Intended use case for this is to fetch environment variables from a file that is bundled with the application. This is the most common use case for SPA apps and is the one that is used in the example application.</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">apps/environment-variables-fetch-example/src/main.ts</div><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">fetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;./assets/env.json&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">env</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">platformBrowserDynamic</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">provideEnvironmentVariables</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">env</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">bootstrapModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">AppModule</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword" style="color:#00009f">catch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In <code>env.json</code>, you would have something like this:</p><div class="codeBlockContainer_J+bg language-json theme-code-block"><div style="color:#393A34;background-color:#f6f8fa" class="codeBlockTitle_oQzk">apps/environment-variables-fetch-example/src/assets/env.json</div><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;API_URL&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://api.example.com&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>env.json</code> file should be committed and the committed values in the file should be the values you use during development.</p><p>When you deploy the app to some environment, you build the application artifacts only once and the DevOps team should implement value replacements of properties in <code>dist/assets/env.json</code> file. This replacement must happen after the build, but before the application is deployed (basically copied to production server as static files). This way, user&#x27;s browser will fetch <code>env.json</code> when the app starts and use the values that are set in the file. Values can, of course, be set per-environment (that is the whole point of this feature).</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="232-for-ssr--angular-universal-apps---provideuniversalenvironmentvariables">2.3.2. For SSR / Angular Universal Apps - <code>provideUniversalEnvironmentVariables</code><a class="hash-link" href="#232-for-ssr--angular-universal-apps---provideuniversalenvironmentvariables" title="Direct link to heading">â€‹</a></h3><p>The setup for Angular Universal is similar, but there is no env.json file that is fetched. This files was necessary for SPA apps because there is no application runtime, only statically built and served files. However, with SSR, there is a runtime and we can access <code>process.env</code> to read values from system-level environment variables.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="providers-and-their-configuration">Providers and their configuration<a class="hash-link" href="#providers-and-their-configuration" title="Direct link to heading">â€‹</a></h4><p>There are two providers that enable use of environment variables on both the server and the client:</p><ol><li><code>provideUniversalEnvironmentVariables</code> - ensures that variables can be read on both server and the client<ul><li>a configuration object allows you to specify which variables are public and which are private. Public variables will be transferred from server to client, while private ones will be kept only on the server</li></ul></li><li><code>provideProcess</code> - provides the global <code>process</code> object for use on the server</li></ol><h4 class="anchor anchorWithStickyNavbar_y2LR" id="module-configuration">Module configuration<a class="hash-link" href="#module-configuration" title="Direct link to heading">â€‹</a></h4><p>Add <code>provideUniversalEnvironmentVariables</code> to the <code>AppModule</code> (not <code>AppServerModule</code>!):</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> provideUniversalEnvironmentVariables </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@infinum/ngx-nuts-and-bolts-ssr&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">provideUniversalEnvironmentVariables</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            publicVariables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Foo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            privateVariables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Bar</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Update <code>AppServerModule</code> by adding <code>provideProcess</code> provider:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> provideProcess </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@infinum/ngx-nuts-and-bolts-ssr&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token function maybe-class-name" style="color:#d73a49">NgModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">provideProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name maybe-class-name">AppServerModule</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="standalone-components-configuration">Standalone-components configuration<a class="hash-link" href="#standalone-components-configuration" title="Direct link to heading">â€‹</a></h4><p>If you do not use modules and use a standalone component for bootstrapping the app, you must update your application config like so:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">ApplicationConfig</span><span class="token imports"> </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> provideUniversalEnvironmentVariables </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@infinum/ngx-nuts-and-bolts-ssr&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> appConfig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ApplicationConfig</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">provideUniversalEnvironmentVariables</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            publicVariables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Foo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            privateVariables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Bar</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Value for `Bar` will be `undefined` in the browser, but preset on the server.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Next, update server application config:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> </span><span class="token imports maybe-class-name">ApplicationConfig</span><span class="token imports punctuation" style="color:#393A34">,</span><span class="token imports"> mergeApplicationConfig </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/core&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> provideServerRendering </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@angular/platform-server&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> provideProcess </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@infinum/ngx-nuts-and-bolts-ssr&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> appConfig </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;./app.config&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverConfig</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">ApplicationConfig</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token function" style="color:#d73a49">provideServerRendering</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">provideProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mergeApplicationConfig</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">appConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> serverConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Please notice that the config used for bootstrapping the application on the server merges the base config with browser-specific config. To draw a comparison with the module-based approach, base config is basically what was in <code>AppModule</code> and server config is what was in <code>AppServerModule</code>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="implementation-details">Implementation details<a class="hash-link" href="#implementation-details" title="Direct link to heading">â€‹</a></h4><p><em>Implementation detail</em> - <a href="https://angular.io/api/platform-browser/TransferState" target="_blank" rel="noopener noreferrer"><code>TransferState</code></a> is used to transfer public variables from Node to browser, while private ones are kept only on server and are not transferred to the client.</p><p>Because the node part of the app will read values from <code>process.env</code>, you must provide the global <code>process</code> object under <code>PROCESS</code> DI token. You can do so by using <code>provideProcess</code> functional provider. This is done so that <code>process.env</code> is not hard-coded in <code>provideUniversalEnvironmentVariables</code> provider, making unit testing easier.</p><p>When running the app on production server, simply set environment variables in one of the standard ways:</p><ol><li>API_URL=<a href="https://api.example.com" target="_blank" rel="noopener noreferrer">https://api.example.com</a> node server.js</li><li>export API_URL=<a href="https://api.example.com" target="_blank" rel="noopener noreferrer">https://api.example.com</a> &amp;&amp; node server.js</li><li>save API_URL=<a href="https://api.example.com" target="_blank" rel="noopener noreferrer">https://api.example.com</a> in .env file and source it in server.ts (e.g. using <a href="https://www.npmjs.com/package/dotenv" target="_blank" rel="noopener noreferrer"><code>dotenv</code></a> NPM package for Node.js)</li></ol><p>For development, you can easily define values for variables in a local .env file and source it however you like (e.g. using <a href="https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/dotenv" target="_blank" rel="noopener noreferrer"><code>dotenv</code> ohmyzsh plugin</a> or rely on <a href="https://www.npmjs.com/package/dotenv" target="_blank" rel="noopener noreferrer"><code>dotenv</code></a> implementation in <code>server.ts</code>);</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="233-custom-setup-using-environment_variables_record">2.3.3. Custom setup using <code>ENVIRONMENT_VARIABLES_RECORD</code><a class="hash-link" href="#233-custom-setup-using-environment_variables_record" title="Direct link to heading">â€‹</a></h3><p>This method gives you flexibility to implement a custom way of initializing environment variables record. You can provide the record containing values for environment variables yourself, by manually setting value for <code>ENVIRONMENT_VARIABLES_RECORD</code> DI token. This is what both <code>provideEnvironmentVariables</code> and <code>provideUniversalEnvironmentVariables</code> do internally.</p><p>The of the object that you provide under <code>ENVIRONMENT_VARIABLES_RECORD</code> has to satisfy <code>EnvironmentVariablesRecord</code> generic type. This type receives a generic that is the enum of your available variables.</p><p>If you do this, do not use <code>provideEnvironmentVariables</code> nor <code>provideUniversalEnvironmentVariables</code> providers.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="3-example-applications">3. Example applications<a class="hash-link" href="#3-example-applications" title="Direct link to heading">â€‹</a></h2><p>Please check out the source code repository for two example applications. Example applications use standalone components for bootstrapping the app, but the same principles apply to module-based apps.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="31-single-page-app-with-fetching">3.1 Single-page App with fetching<a class="hash-link" href="#31-single-page-app-with-fetching" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/infinum/ngx-nuts-and-bolts/tree/main/apps/environment-variables-fetch-example" target="_blank" rel="noopener noreferrer"><code>apps/environment-variables-fetch-example</code></a> demonstrates an example that uses <code>provideEnvironmentVariables</code> provider. In <code>main.ts</code> (before the application is loaded), <code>./assets/env.json</code> is fetched using <code>fetch</code> and the application is bootstrapped with the <code>provideEnvironmentVariables</code> provider. You can start this example with <code>npm run start:environment-variables-fetch-example</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="32-angular-universal-app-with-ssr">3.2 Angular Universal App with SSR<a class="hash-link" href="#32-angular-universal-app-with-ssr" title="Direct link to heading">â€‹</a></h3><p><a href="https://github.com/infinum/ngx-nuts-and-bolts/tree/main/apps/environment-variables-ssr-example" target="_blank" rel="noopener noreferrer"><code>apps/environment-variables-ssr-example</code></a> uses <code>provideUniversalEnvironmentVariables</code> provider. The application has to be started with environment variables exposed to the node process that is running the SSR app. You can start this example with <code>npm run start:environment-variables-ssr-example</code>.</p><p>For this example, <code>Foo</code> variable is set as public, and <code>Bar</code> is set as private. That is why you don&#x27;t see value for <code>Bar</code> in the browser, but you will see it in the console of the node process.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="4-unit-testing">4. Unit testing<a class="hash-link" href="#4-unit-testing" title="Direct link to heading">â€‹</a></h2><p>For unit testing, simply call <code>provideEnvironmentVariables</code> with desired values for that specific test suite and <code>EnvironmentVariablesService</code> will use those values. You do not have to provide <code>EnvironmentVariablesService</code> explicitly, as it has <code>providedIn: &#x27;root&#x27;</code>. <code>TestBed</code> configuration example:</p><div class="codeBlockContainer_J+bg language-ts theme-code-block"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token maybe-class-name">TestBed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">configureTestingModule</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    providers</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">provideEnvironmentVariables</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Foo</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;I am Foo (testing)&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">EnvironmentVariable</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Bar</span><span class="token punctuation" style="color:#393A34">]</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;I am Bar (testing)&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">envService </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">TestBed</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">inject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">EnvironmentVariablesService</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="5-opinion-piece---what-about-angulars-environment-files">5. Opinion piece - what about Angular&#x27;s <code>environment</code> files?<a class="hash-link" href="#5-opinion-piece---what-about-angulars-environment-files" title="Direct link to heading">â€‹</a></h2><p>While Angular provides environment files out-of-the-box (one for development and one for production), but they are not the best solution to this problem for multiple reasons:</p><ul><li>Any changes to these files require application re-build and re-deployment</li><li>Adding a new requirement requires code changes</li><li>One build per environment<ul><li>At best, this is sub-optimal</li><li>At worst, it can lead to situations where you think that the builds for different environments were made from the same commit, but something might have been pushed in the meantime and the builds will be different</li></ul></li><li>One file is required for each environment</li><li>A configuration entry has to be added to <code>angular.json</code> for each file</li><li>Conceptually, the frontend repository should not care about any URLs or other values that are related to the deployment process - they should be stored in the deployment pipeline<ul><li>The only thing that is OK to keep in the frontend repository are URLs for development proxies</li></ul></li><li>Some projects have a CI/CD setup such that each branch gets deployed to some unique environment so that the application is available online as part of pull request and design review processes. This is basically impossible to do with environment files without some hacky file copying and/or search-and-replace of some placeholder values</li></ul><p>Although these out-of-the-box files are named <code>environment.ts</code> and <code>environment.prod.ts</code>, Angular CLI has refers to these files in the <code>configurations</code> segment of <code>angular.json</code>. Basically, there is a 1-to-1 mapping between build configurations in <code>angular.json</code> and <code>environment.ts</code> files. <code>configurations</code> would probably be a more suitable name because these files are not the best fit for defining environment-specific values likeAPI URL, for all the reasons mentioned before. The main purpose for these files should be to define differences in build configurations - think of them as pragmas. Out-of-the-box they are used to determine whether Angular should run in production or development mode. Similar to the out-of-the-box <code>production</code> boolean property, you might have some custom properties that are used, for example, to determine if something should be logged or not in different build configurations.</p><p>Even though one of the configurations is called <code>production</code> and the other <code>development</code>, these are usually the only two configurations you actually need. In environments where it is important to provide a optimized build to the end-user, use <code>production</code> configuration. In environments where it is important that you can easily debug the deployed code, use <code>development</code> configuration. Even if you have many different environments, you are probably still ok with using one of these two configurations in each of the environments (e.g. <code>production</code> configuration for production and pre-production environments and <code>development</code> for development environments). You might want to add one additional middle-ground configuration that has all the optimizations enabled, but also includes sourcemaps that can be used to help with debugging. Basically <code>production</code> configuration + sourcemaps on top.</p><p>We can only hope that one day Angular CLI completely drops <code>environment</code> from naming and starts calling these files <code>configuration</code> files (e.g. <code>configuration.dev.ts</code>, <code>configuration.prod.ts</code>). This would better convey use cases where these files are a good fit. Environment variables should be kept out of these files in most applications. If you think these files will work for your use case, feel free to use them. However, we believe that they are not a good fit for anything other than some really small-scale and/or demo projects.</p><p>As a final nail in the coffin for developers defaulting to using <code>environment</code> files for things like API_URL, <a href="https://github.com/angular/angular-cli/commit/283b564d1de985f0af8c2fcb6192801a90baacda" target="_blank" rel="noopener noreferrer">Angular CLI removed generation of these files for new projects in version 15</a>. You can still enable them after the project is generated, but it is no longer there by default and the usage of these files is discouraged for anything other than defining differences in build configurations (e.g. build with MSW handlers or without).</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ngx-nuts-and-bolts/docs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ngx-nuts-and-bolts/docs/loading-state"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Loading state helpers</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-introduction" class="table-of-contents__link toc-highlight">1. Introduction</a></li><li><a href="#2-features" class="table-of-contents__link toc-highlight">2. Features</a></li><li><a href="#21-available-variables-enum" class="table-of-contents__link toc-highlight">2.1. Available variables enum</a></li><li><a href="#22-environmentvariablesservice" class="table-of-contents__link toc-highlight">2.2. <code>EnvironmentVariablesService</code></a><ul><li><a href="#221-methods" class="table-of-contents__link toc-highlight">2.2.1. Methods</a></li><li><a href="#222-configuration" class="table-of-contents__link toc-highlight">2.2.2. Configuration</a></li></ul></li><li><a href="#23-providers" class="table-of-contents__link toc-highlight">2.3 Providers</a><ul><li><a href="#231-for-spa-apps---provideenvironmentvariables" class="table-of-contents__link toc-highlight">2.3.1. For SPA Apps - <code>provideEnvironmentVariables</code></a></li><li><a href="#232-for-ssr--angular-universal-apps---provideuniversalenvironmentvariables" class="table-of-contents__link toc-highlight">2.3.2. For SSR / Angular Universal Apps - <code>provideUniversalEnvironmentVariables</code></a></li><li><a href="#233-custom-setup-using-environment_variables_record" class="table-of-contents__link toc-highlight">2.3.3. Custom setup using <code>ENVIRONMENT_VARIABLES_RECORD</code></a></li></ul></li><li><a href="#3-example-applications" class="table-of-contents__link toc-highlight">3. Example applications</a><ul><li><a href="#31-single-page-app-with-fetching" class="table-of-contents__link toc-highlight">3.1 Single-page App with fetching</a></li><li><a href="#32-angular-universal-app-with-ssr" class="table-of-contents__link toc-highlight">3.2 Angular Universal App with SSR</a></li></ul></li><li><a href="#4-unit-testing" class="table-of-contents__link toc-highlight">4. Unit testing</a></li><li><a href="#5-opinion-piece---what-about-angulars-environment-files" class="table-of-contents__link toc-highlight">5. Opinion piece - what about Angular&#39;s <code>environment</code> files?</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 Infinum</div></div></div></footer></div>
<script src="/ngx-nuts-and-bolts/assets/js/runtime~main.e09e271c.js"></script>
<script src="/ngx-nuts-and-bolts/assets/js/main.565489e3.js"></script>
</body>
</html>