"use strict";(self.webpackChunkngx_nuts_and_bolts_docs=self.webpackChunkngx_nuts_and_bolts_docs||[]).push([[558],{3905:function(e,t,r){r.d(t,{Zo:function(){return u},kt:function(){return m}});var n=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,c=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=l(r),m=o,f=p["".concat(c,".").concat(m)]||p[m]||d[m]||a;return r?n.createElement(f,s(s({ref:t},u),{},{components:r})):n.createElement(f,s({ref:t},u))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,s=new Array(a);s[0]=p;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var l=2;l<a;l++)s[l]=r[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}p.displayName="MDXCreateElement"},7486:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return i},contentTitle:function(){return c},metadata:function(){return l},toc:function(){return u},default:function(){return p}});var n=r(7462),o=r(3366),a=(r(7294),r(3905)),s=["components"],i={id:"async-error",title:"Async error",sidebar_label:"Async error"},c=void 0,l={unversionedId:"testing-utils/async-error",id:"testing-utils/async-error",title:"Async error",description:"If and when returning mocked error from the testing service or in tests, users should avoid doing something like this:",source:"@site/docs/testing-utils/async-error.md",sourceDirName:"testing-utils",slug:"/testing-utils/async-error",permalink:"/ngx-nuts-and-bolts/docs/testing-utils/async-error",tags:[],version:"current",frontMatter:{id:"async-error",title:"Async error",sidebar_label:"Async error"},sidebar:"mainSidebar",previous:{title:"Async data",permalink:"/ngx-nuts-and-bolts/docs/testing-utils/async-data"},next:{title:"Mock storage",permalink:"/ngx-nuts-and-bolts/docs/testing-utils/mock-storage"}},u=[{value:"1. Usage",id:"1-usage",children:[{value:"1.1. Test double scenario",id:"11-test-double-scenario",children:[],level:3},{value:"1.2. Test suite scenario",id:"12-test-suite-scenario",children:[],level:3}],level:2}],d={toc:u};function p(e){var t=e.components,r=(0,o.Z)(e,s);return(0,a.kt)("wrapper",(0,n.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"If and when returning mocked error from the testing service or in tests, users should avoid doing something like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"public getData(data: TData): Observable<TData>{\n    if(!data){\n        return of(throwError(new HttpErrorResponse({ error: { message: 'The data cannot be found' }, status: 404 })));\n    }\n    ...\n}\n")),(0,a.kt)("p",null,"or"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"describe('synchronous error throwing', () => {\n    ...\n    it('should return not found error if data does not exist', () => {\n        spyOn(mockService, 'mockMethod').and.returnValue(of(new HttpErrorResponse({ error: { message: 'The data cannot be found' }, status: 404 })));\n        );\n    });\n});\n\n")),(0,a.kt)("p",null,"The examples above throw observable errors but it ",(0,a.kt)("a",{parentName:"p",href:"https://stackblitz.com/edit/rxjs-hx8yos?devtoolsheight=60"},"returns them synchronously"),". This isn't how services that make API calls behave in real world applications.\nThe purpose of creating test doubles for services or simulating async behavior directly in test suits is to mock the behavior of real world services as closely as possible. This can can be achieved in multiple ways.\nThis specific implementation uses ",(0,a.kt)("inlineCode",{parentName:"p"},"observeOn")," operator with ",(0,a.kt)("inlineCode",{parentName:"p"},"asyncScheduler"),", creating a new macrotask that places the observable in the event loop queue."),(0,a.kt)("h2",{id:"1-usage"},"1. Usage"),(0,a.kt)("p",null,"When returning the mocked error in test suites or test doubles, simply wrap the error data using ",(0,a.kt)("inlineCode",{parentName:"p"},"asyncError")," function and the error will be returned asynchronously."),(0,a.kt)("h3",{id:"11-test-double-scenario"},"1.1. Test double scenario"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"export class MockedDataFetchingService {\n    public getSomeData(data: TData): Observable<TData> {\n        return data\n            ? asyncData(data)\n            : asyncError(new HttpErrorResponse({ error: { message: 'The data cannot be found' }, status: 404 }));\n    }\n}\n")),(0,a.kt)("h3",{id:"12-test-suite-scenario"},"1.2. Test suite scenario"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"describe('asyncError demo', () => {\n    ...\n    it('should return not found error if data does not exist', () => {\n        spyOn(mockService, 'mockMethod').and.returnValue(\n            asyncError(new HttpErrorResponse({ error: { message: 'The data cannot be found' }, status: 404 }))\n        );\n    });\n});\n")))}p.isMDXComponent=!0}}]);